# BL-004: スコアボード表示機能

## 概要
ゲーム進行中のリアルタイムスコア表示機能を実装する。

## 背景
BL-001でスコア入力が可能になった後、現在のゲーム状況を一目で把握できるスコアボード表示が必要。プレイヤーが現在の持ち点や順位を簡単に確認できる機能を提供する。

## 要件

### 機能要件
1. **リアルタイムスコア表示**
   - 各プレイヤーの現在持ち点
   - 現在の順位（1位〜4位）
   - 基準点からの差分表示

2. **ゲーム進行情報**
   - 現在の局数（東1局、南2局など）
   - 本場数
   - リーチ棒の数
   - 進行中/終了の状態表示

3. **視覚的表現**
   - 順位による色分け
   - 得点変動のアニメーション
   - プラス/マイナスの視覚的区別

4. **操作機能**
   - スコア入力画面への遷移
   - 局の履歴表示
   - ゲーム終了処理への遷移

### 非機能要件
- レスポンシブデザイン
- 60FPS でのアニメーション
- 直感的なUI/UX

## 技術設計

### 状態管理
```dart
class GameState {
  final Game game;
  final List<Player> players;
  final List<Round> rounds;
  final Map<int, int> currentScores;
  final Round? currentRound;
  final bool isFinished;
}

final gameStateProvider = StateNotifierProvider.family<GameStateNotifier, GameState?, int>((ref, gameId) {
  return GameStateNotifier(gameId, ref);
});
```

### UI コンポーネント
1. **PlayerScoreCard**
   - プレイヤー名
   - 現在得点
   - 順位バッジ
   - 得点変動インジケーター

2. **GameProgressIndicator**
   - 現在局表示
   - 進行状況バー
   - 本場・リーチ棒表示

3. **ScoreboardGrid**
   - 4プレイヤーのスコアカードをグリッド表示
   - レスポンシブレイアウト

### データ取得
- ゲーム情報の取得
- プレイヤー一覧の取得
- 局履歴の取得と集計
- リアルタイム更新（ProviderのInvalidation）

## UI設計

### レイアウト構成
```
┌─────────────────────────────────┐
│ ゲーム進行情報（局数、本場等）      │
├─────────────────────────────────┤
│ ┌─────────┐  ┌─────────┐      │
│ │プレイヤー1│  │プレイヤー2│      │
│ │順位・得点 │  │順位・得点 │      │
│ └─────────┘  └─────────┘      │
│ ┌─────────┐  ┌─────────┐      │
│ │プレイヤー3│  │プレイヤー4│      │
│ │順位・得点 │  │順位・得点 │      │
│ └─────────┘  └─────────┘      │
├─────────────────────────────────┤
│ [スコア入力] [履歴] [終了]        │
└─────────────────────────────────┘
```

### 色分けルール
- 1位: 金色/黄色系
- 2位: 銀色/灰色系  
- 3位: 青色系
- 4位: 赤色系

## 画面遷移

### 現在のBoardScreenとの関係
現在のBoardScreenはゲーム情報とプレイヤー一覧の表示のみ。この機能実装により以下に拡張：

1. **強化内容**
   - スコア表示の追加
   - リアルタイム更新
   - ゲーム進行状況の表示

2. **画面遷移**
   ```
   BoardScreen（強化版）
   ├── ScoreInputScreen（BL-001）
   ├── RoundHistoryScreen（将来実装）
   └── GameResultScreen（BL-002）
   ```

## 受け入れ条件
- [ ] 各プレイヤーの現在得点が正確に表示される
- [ ] 順位が正しく計算・表示される
- [ ] ゲーム進行情報（局数等）が表示される
- [ ] スコア更新時にリアルタイムで画面が更新される
- [ ] 順位による色分けが適用される
- [ ] スコア入力画面への遷移ボタンが機能する
- [ ] レスポンシブデザインに対応している
- [ ] 得点変動時のアニメーションが動作する

## 依存関係
- **前提条件**: BL-001（スコア入力機能）
- **並行実装**: BL-002（得点計算機能）
- **後続タスク**: BL-003（半荘記録機能）

## 見積もり
- **ストーリーポイント**: 5
- **作業時間**: 1-2日
- **難易度**: 中

## 補足
- 既存のBoardScreenを拡張する形で実装
- アニメーションはFlutterの標準ウィジェットを活用
- 将来的には横画面レイアウトも対応予定
- 音声・バイブレーション機能は別タスクで対応